<!DOCTYPE html>
<html>
<head>
<style>
    #div_num_planes {
        text-align: center;
    }

    #label_num_planes {
        font-size: 2vw;
    }

    #num_planes {
        font-size: 2vw;
    }

    #planes {
        font-size: 4vw;
        text-align: center;
    }

    #buttons {
        text-align: center;
    }

    #show_answer {
        font-size: 4vw;
    }

    #reset {
        font-size: 4vw;
    }

    #answer {
        font-size: 4vw;
        text-align: center;
    }
</style>
</head>
<body>
    <div id="div_num_planes">
        <label id="label_num_planes" for="num_planes">Number of planes: </label>
        <select name="num_planes" id="num_planes">
            <option value=2>2</option>
            <option value=3>3</option>
            <option value=4>4</option>
            <option value=5 selected="selected">5</option>
            <option value=6>6</option>
            <option value=7>7</option>
            <option value=8>8</option>
            <option value=9>9</option>
            <option value=10>10</option>
        </select>
    </div>
    <p id="planes"></p>
    <div id="buttons">
        <button id="show_answer">Answer</button>
        <button id ="reset">Reset</button>
    </div>
    <p id="answer"></p>

<script type="text/javascript">

const SUPER = "J";
const HEAVY = "H";
const LARGE = "L";
const SMALL = "S";
const MIN_SEPARATION = 4;
const CHANCE_SUPER = 0.1;
const CHANCE_HEAVY = 0.3;
const CHANCE_LARGE = 0.5;
const CHANCE_SMALL = 0.1;

function generate_sequence(num_planes) {
    let sequence = [];

    for (let i = 0; i < num_planes; i++) {
        const rand = Math.random();
        if (rand < CHANCE_SUPER) {
            sequence.push(SUPER);
        }
        else if (rand < CHANCE_SUPER + CHANCE_HEAVY) {
            sequence.push(HEAVY);
        }
        else if (rand < CHANCE_SUPER + CHANCE_HEAVY + CHANCE_LARGE) {
            sequence.push(LARGE);
        }
        else if (rand < 1) {
            sequence.push(SMALL);
        }
    }

    const num_J = sequence.filter(plane => plane === SUPER).length;
    for (let i = num_J; i > Math.max(1, CHANCE_SUPER * num_planes); i--) {
        sequence[sequence.findIndex(plane => plane === SUPER)] = LARGE;
    }

    const num_H = sequence.filter(plane => plane === HEAVY).length;
    for (let i = num_H; i > Math.max(2, CHANCE_HEAVY * num_planes); i--) {
        sequence[sequence.findIndex(plane => plane === HEAVY)] = LARGE;
    }

    const num_S = sequence.filter(plane => plane === SMALL).length;
    for (let i = num_S; i > Math.max(2, CHANCE_SMALL * num_planes); i--) {
        sequence[sequence.findIndex(plane => plane === SMALL)] = LARGE;
    }

    return sequence;
};

function calculate_separation(sequence) {
    let wake_turb_sep = 0;

    for (let i = 1; i < sequence.length; i++) {
        const first = sequence[i-1];
        const second = sequence[i];

        wake_turb_sep += MIN_SEPARATION;
        if (first === SUPER) {
            if (second === HEAVY) {
                wake_turb_sep += 4;
            } else if (second === LARGE) {
                wake_turb_sep += 5;
            } else if (second === SMALL) {
                wake_turb_sep += 6;
            }
        } else if (first === HEAVY) {
            if (second === HEAVY) {
                wake_turb_sep += 2;
            } else if (second === LARGE) {
                wake_turb_sep += 3;
            } else if (second === SMALL) {
                wake_turb_sep += 4;
            }
        } else if (first === LARGE) {
            if (second === SMALL) {
                wake_turb_sep += 2;
            }
        }
    }

    return wake_turb_sep;
};

function reset() {
    const select_num_planes = document.getElementById("num_planes");
    const num_planes = select_num_planes.options[select_num_planes.selectedIndex].value;
    let sequence = generate_sequence(num_planes);
    document.getElementById("planes").innerText = sequence.join("â‡½");

    const text_answer = document.getElementById("answer")
    text_answer.innerText = "";
    document.getElementById("show_answer").onclick = function() {
        text_answer.innerText = calculate_separation(sequence);
    };
};

document.getElementById("reset").onclick = reset;

reset();

</script>
</body>
</html>

